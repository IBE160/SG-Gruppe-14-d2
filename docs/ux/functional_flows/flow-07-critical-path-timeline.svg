<svg viewBox="0 0 1600 2000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: 'Inter', sans-serif; font-size: 28px; font-weight: 700; fill: #111827; }
      .subtitle { font-family: 'Inter', sans-serif; font-size: 14px; fill: #6B7280; }
      .heading { font-family: 'Inter', sans-serif; font-size: 16px; font-weight: 600; fill: #111827; }
      .body-text { font-family: 'Inter', sans-serif; font-size: 13px; fill: #374151; }
      .small-text { font-family: 'Inter', sans-serif; font-size: 11px; fill: #6B7280; }
      .critical-box { fill: #FEE2E2; stroke: #EF4444; stroke-width: 3; }
      .non-critical-box { fill: #F3F4F6; stroke: #9CA3AF; stroke-width: 2; }
      .timeline-box { fill: #DBEAFE; stroke: #3B82F6; stroke-width: 2; }
      .formula-box { fill: #E0E7FF; stroke: #6366F1; stroke-width: 2; }
      .code-text { font-family: 'Courier New', monospace; font-size: 10px; fill: #1F2937; }
      .arrow { stroke: #6B7280; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .arrow-critical { stroke: #EF4444; stroke-width: 3; fill: none; marker-end: url(#arrowhead-critical); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#6B7280" />
    </marker>
    <marker id="arrowhead-critical" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#EF4444" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="800" y="40" class="title" text-anchor="middle">Kritisk Sti og Tidslinjeberegning</text>
  <text x="800" y="65" class="subtitle" text-anchor="middle">CPM (Critical Path Method) for Nye HÃ¦dda Barneskole</text>

  <!-- Project Timeline -->
  <rect x="50" y="100" width="1500" height="120" rx="8" fill="#F9FAFB" stroke="#D1D5DB" stroke-width="2"/>
  <text x="800" y="130" class="heading" text-anchor="middle">ğŸ“… PROSJEKTTIDSLINJE</text>

  <text x="70" y="160" class="body-text" font-weight="600">Start: 15. februar 2025</text>
  <text x="70" y="180" class="body-text" font-weight="600" fill="#EF4444">Frist: 15. mai 2026 (UFRAVIKELIG)</text>
  <text x="70" y="200" class="body-text">Total tid tilgjengelig: 455 dager (ca. 15 mÃ¥neder)</text>

  <text x="900" y="160" class="body-text" font-weight="600">Milestone: Skolestart august 2026</text>
  <text x="900" y="180" class="body-text">Buffer fÃ¸r skolestart: ~2.5 mÃ¥neder</text>
  <text x="900" y="200" class="body-text">Samfunnskostnad ved forsinkelse: EKSTREMT HÃ˜Y</text>

  <!-- WBS Dependency Diagram -->
  <text x="800" y="270" class="heading" text-anchor="middle">ğŸ”— WBS PAKKER OG AVHENGIGHETER</text>

  <!-- Locked packages (non-critical) -->
  <rect x="50" y="300" width="1500" height="180" rx="8" class="non-critical-box"/>
  <text x="800" y="330" class="heading" text-anchor="middle" fill="#6B7280">12 LÃ¥ste Pakker (390 MNOK) - Ikke pÃ¥ kritisk sti</text>

  <text x="70" y="360" class="body-text">Eksempler (parallelle aktiviteter):</text>

  <rect x="100" y="375" width="220" height="60" rx="6" fill="#FFFFFF" stroke="#9CA3AF" stroke-width="1"/>
  <text x="210" y="395" class="small-text" text-anchor="middle">Prosjektering</text>
  <text x="210" y="410" class="small-text" text-anchor="middle">30 MNOK | 30 dager</text>
  <text x="210" y="425" class="small-text" text-anchor="middle">Parallell</text>

  <rect x="360" y="375" width="220" height="60" rx="6" fill="#FFFFFF" stroke="#9CA3AF" stroke-width="1"/>
  <text x="470" y="395" class="small-text" text-anchor="middle">RIB</text>
  <text x="470" y="410" class="small-text" text-anchor="middle">25 MNOK | 20 dager</text>
  <text x="470" y="425" class="small-text" text-anchor="middle">Parallell</text>

  <rect x="620" y="375" width="220" height="60" rx="6" fill="#FFFFFF" stroke="#9CA3AF" stroke-width="1"/>
  <text x="730" y="395" class="small-text" text-anchor="middle">Elektrisk</text>
  <text x="730" y="410" class="small-text" text-anchor="middle">35 MNOK | 45 dager</text>
  <text x="730" y="425" class="small-text" text-anchor="middle">Parallell</text>

  <text x="900" y="410" class="small-text">... + 9 andre pakker (RÃ¸rarbeid, VVS, Vinduer, etc.)</text>

  <text x="70" y="465" class="small-text" fill="#6B7280">Disse pakkene kan kjÃ¸res parallelt og pÃ¥virker IKKE kritisk sti.</text>

  <!-- Critical Path (3 negotiable packages) -->
  <rect x="50" y="520" width="1500" height="280" rx="8" class="critical-box"/>
  <text x="800" y="555" class="heading" text-anchor="middle" fill="#EF4444">ğŸš¨ KRITISK STI - 3 Forhandlingsbare Pakker (SEKVENSIELL)</text>

  <text x="70" y="585" class="body-text" font-weight="600" fill="#EF4444">Disse mÃ¥ gjÃ¸res i rekkefÃ¸lge (finish-to-start dependency):</text>

  <!-- WBS 1.3.1 -->
  <rect x="150" y="610" width="280" height="140" rx="6" class="critical-box"/>
  <text x="290" y="640" class="heading" text-anchor="middle" fill="#EF4444">WBS 1.3.1</text>
  <text x="290" y="660" class="body-text" text-anchor="middle">Grunnarbeid</text>
  <text x="170" y="685" class="small-text">Baseline: 105 MNOK, 60 dager</text>
  <text x="170" y="705" class="small-text">Agent: BjÃ¸rn Eriksen</text>
  <text x="170" y="725" class="small-text">Start: Dag 1 (15 Feb 2025)</text>
  <text x="170" y="740" class="small-text" font-weight="600">Slutt: Dag 60 (16 Apr 2025)</text>

  <path d="M 430 680 L 530 680" class="arrow-critical"/>
  <text x="480" y="670" class="small-text" text-anchor="middle" fill="#EF4444">FS</text>

  <!-- WBS 1.3.2 -->
  <rect x="530" y="610" width="280" height="140" rx="6" class="critical-box"/>
  <text x="670" y="640" class="heading" text-anchor="middle" fill="#EF4444">WBS 1.3.2</text>
  <text x="670" y="660" class="body-text" text-anchor="middle">Fundamentering</text>
  <text x="550" y="685" class="small-text">Baseline: 60 MNOK, 45 dager</text>
  <text x="550" y="705" class="small-text">Agent: Kari Andersen</text>
  <text x="550" y="725" class="small-text">Start: Dag 61 (17 Apr 2025)</text>
  <text x="550" y="740" class="small-text" font-weight="600">Slutt: Dag 105 (1 Jun 2025)</text>

  <path d="M 810 680 L 910 680" class="arrow-critical"/>
  <text x="860" y="670" class="small-text" text-anchor="middle" fill="#EF4444">FS</text>

  <!-- WBS 1.4.1 -->
  <rect x="910" y="610" width="280" height="140" rx="6" class="critical-box"/>
  <text x="1050" y="640" class="heading" text-anchor="middle" fill="#EF4444">WBS 1.4.1</text>
  <text x="1050" y="660" class="body-text" text-anchor="middle">RÃ¥bygg</text>
  <text x="930" y="685" class="small-text">Baseline: 180 MNOK, 90 dager</text>
  <text x="930" y="705" class="small-text">Agent: Per Johansen</text>
  <text x="930" y="725" class="small-text">Start: Dag 106 (2 Jun 2025)</text>
  <text x="930" y="740" class="small-text" font-weight="600">Slutt: Dag 195 (30 Aug 2025)</text>

  <text x="70" y="780" class="body-text" font-weight="600">Total Kritisk Sti (baseline): 60 + 45 + 90 = 195 dager (6.5 mÃ¥neder)</text>

  <!-- CPM Calculation -->
  <rect x="50" y="840" width="1500" height="480" rx="8" class="formula-box"/>
  <text x="800" y="875" class="heading" text-anchor="middle">ğŸ“ CPM BEREGNING (Critical Path Method)</text>

  <text x="70" y="910" class="body-text" font-weight="600">Formel:</text>
  <text x="90" y="930" class="code-text">project_end_date = START_DATE + sum(critical_path_durations)</text>
  <text x="90" y="945" class="code-text">critical_path_duration = WBS_1.3.1 + WBS_1.3.2 + WBS_1.4.1</text>

  <text x="70" y="975" class="body-text" font-weight="600">Baseline Scenario (ingen forhandling):</text>
  <text x="90" y="995" class="code-text">Start: 15 Feb 2025 (Dag 1)</text>
  <text x="90" y="1010" class="code-text">WBS 1.3.1: 60 dager â†’ Slutt 16 Apr 2025</text>
  <text x="90" y="1025" class="code-text">WBS 1.3.2: 45 dager â†’ Slutt 1 Jun 2025</text>
  <text x="90" y="1040" class="code-text">WBS 1.4.1: 90 dager â†’ Slutt 30 Aug 2025</text>
  <text x="90" y="1055" class="code-text">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</text>
  <text x="90" y="1070" class="code-text">Prosjektslutt: 30 Aug 2025 (Dag 195)</text>
  <text x="90" y="1085" class="code-text">Frist: 15 Mai 2026 (Dag 455)</text>
  <text x="90" y="1100" class="code-text">Buffer: 260 dager (8.6 mÃ¥neder) âœ… GOD MARGIN</text>

  <text x="70" y="1130" class="body-text" font-weight="600">Forhandlet Scenario (raskere levering):</text>
  <text x="90" y="1150" class="code-text">WBS 1.3.1: 50 dager (forhandlet ned 10 dager)</text>
  <text x="90" y="1165" class="code-text">WBS 1.3.2: 38 dager (forhandlet ned 7 dager)</text>
  <text x="90" y="1180" class="code-text">WBS 1.4.1: 80 dager (forhandlet ned 10 dager)</text>
  <text x="90" y="1195" class="code-text">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</text>
  <text x="90" y="1210" class="code-text">Total: 168 dager (5.6 mÃ¥neder)</text>
  <text x="90" y="1225" class="code-text">Prosjektslutt: ~1 Aug 2025</text>
  <text x="90" y="1240" class="code-text">Buffer: 287 dager âœ… BEDRE MARGIN</text>

  <text x="70" y="1270" class="body-text" font-weight="600">Kritisk Scenario (tar for lang tid):</text>
  <text x="90" y="1290" class="code-text">WBS 1.3.1: 75 dager (forsinket)</text>
  <text x="90" y="1305" class="code-text">WBS 1.3.2: 60 dager (forsinket)</text>
  <text x="90" y="1320" class="code-text">WBS 1.4.1: 110 dager (forsinket)</text>
  <text x="90" y="1335" class="code-text">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</text>
  <text x="90" y="1350" class="code-text">Total: 245 dager (8.2 mÃ¥neder)</text>
  <text x="90" y="1365" class="code-text">Prosjektslutt: ~20 Okt 2025</text>
  <text x="90" y="1380" class="code-text">Buffer: 207 dager âš ï¸ MINDRE MARGIN (men OK)</text>

  <text x="70" y="1410" class="body-text" font-weight="600" fill="#EF4444">FEIL Scenario (over frist):</text>
  <text x="90" y="1430" class="code-text">WBS 1.3.1: 90 dager</text>
  <text x="90" y="1445" class="code-text">WBS 1.3.2: 75 dager</text>
  <text x="90" y="1460" class="code-text">WBS 1.4.1: 150 dager</text>
  <text x="90" y="1475" class="code-text">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</text>
  <text x="90" y="1490" class="code-text">Total: 315 dager (10.5 mÃ¥neder)</text>
  <text x="90" y="1505" class="code-text">Prosjektslutt: ~26 Des 2025</text>
  <text x="90" y="1520" class="code-text">Tid til frist: 140 dager âš ï¸ UNDER FRIST (men veldig stramt)</text>

  <text x="90" y="1550" class="code-text" fill="#EF4444">WORST CASE: 500+ dager â†’ GÃ¥r OVER 15 Mai 2026 â†’ âŒ FEIL</text>

  <!-- Implementation -->
  <rect x="50" y="1360" width="750" height="300" rx="8" class="timeline-box"/>
  <text x="425" y="1395" class="heading" text-anchor="middle" fill="#3B82F6">ğŸ’» IMPLEMENTERING</text>

  <text x="70" y="1425" class="body-text" font-weight="600">Beregningsfunksjon:</text>
  <text x="90" y="1445" class="code-text">function calculateProjectEnd(wbsItems) {</text>
  <text x="110" y="1460" class="code-text">  const START = new Date("2025-02-15")</text>
  <text x="110" y="1475" class="code-text">  const DEADLINE = new Date("2026-05-15")</text>
  <text x="110" y="1490" class="code-text">  </text>
  <text x="110" y="1505" class="code-text">  // Critical path: Sequential</text>
  <text x="110" y="1520" class="code-text">  const critical = ["1.3.1", "1.3.2", "1.4.1"]</text>
  <text x="110" y="1535" class="code-text">  let totalDays = 0</text>
  <text x="110" y="1550" class="code-text">  </text>
  <text x="110" y="1565" class="code-text">  critical.forEach(id => {</text>
  <text x="130" y="1580" class="code-text">    const wbs = wbsItems.find(w => w.id === id)</text>
  <text x="130" y="1595" class="code-text">    totalDays += wbs.committed_duration || wbs.baseline_duration</text>
  <text x="110" y="1610" class="code-text">  })</text>
  <text x="110" y="1625" class="code-text">  </text>
  <text x="110" y="1640" class="code-text">  const endDate = addDays(START, totalDays)</text>

  <!-- Right side: Validation -->
  <rect x="850" y="1360" width="700" height="300" rx="8" fill="#FEF3C7" stroke="#F59E0B" stroke-width="2"/>
  <text x="1200" y="1395" class="heading" text-anchor="middle" fill="#F59E0B">âœ… VALIDERING</text>

  <text x="870" y="1425" class="body-text" font-weight="600">Tidsfristvalidering:</text>
  <text x="890" y="1445" class="code-text">  return endDate &lt;= DEADLINE</text>
  <text x="890" y="1460" class="code-text">}</text>
  <text x="890" y="1475" class="code-text"></text>
  <text x="890" y="1490" class="code-text">function validateTimeline(wbsItems) {</text>
  <text x="910" y="1505" class="code-text">  const endDate = calculateProjectEnd(wbsItems)</text>
  <text x="910" y="1520" class="code-text">  const deadline = new Date("2026-05-15")</text>
  <text x="910" y="1535" class="code-text">  </text>
  <text x="910" y="1550" class="code-text">  if (endDate &gt; deadline) {</text>
  <text x="930" y="1565" class="code-text">    const delayDays = diffDays(endDate, deadline)</text>
  <text x="930" y="1580" class="code-text">    return {</text>
  <text x="950" y="1595" class="code-text">      valid: false,</text>
  <text x="950" y="1610" class="code-text">      error: "PAST_DEADLINE",</text>
  <text x="950" y="1625" class="code-text">      delay: delayDays,</text>
  <text x="950" y="1640" class="code-text">      end_date: endDate</text>

  <!-- Footer: Important Rules -->
  <rect x="50" y="1700" width="1500" height="260" rx="8" fill="#FEE2E2" stroke="#EF4444" stroke-width="2"/>
  <text x="800" y="1735" class="heading" text-anchor="middle" fill="#EF4444">âš ï¸ KRITISKE REGLER</text>

  <text x="70" y="1770" class="body-text" font-weight="600">1. SEKVENSIELL AVHENGIGHET:</text>
  <text x="90" y="1790" class="body-text">WBS 1.3.1 (Grunnarbeid) MÃ… fullfÃ¸res FÃ˜R WBS 1.3.2 (Fundamentering) starter</text>
  <text x="90" y="1810" class="body-text">WBS 1.3.2 (Fundamentering) MÃ… fullfÃ¸res FÃ˜R WBS 1.4.1 (RÃ¥bygg) starter</text>
  <text x="90" y="1830" class="body-text">Finish-to-Start (FS) dependency â†’ Ingen overlapping mulig</text>

  <text x="70" y="1860" class="body-text" font-weight="600">2. UFRAVIKELIG FRIST:</text>
  <text x="90" y="1880" class="body-text">15. mai 2026 er HARD DEADLINE - Eier kan ALDRI godkjenne forlengelse</text>
  <text x="90" y="1900" class="body-text">Bruker mÃ¥ forhandle for raskere levering hvis over frist</text>

  <text x="70" y="1930" class="body-text" font-weight="600">3. PARALLELLE PAKKER (12 lÃ¥ste):</text>
  <text x="90" y="1950" class="body-text">PÃ¥virker IKKE kritisk sti, kan kjÃ¸res samtidig med kritiske pakker</text>
</svg>
